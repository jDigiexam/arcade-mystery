<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Game Over at the Arcade</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=VT323&display=swap');
        
        body {
            font-family: 'VT323', monospace;
            background-color: #0d0d0d;
            color: #e0e0e0;
            font-size: 1.1rem; /* VT323 is small, so we upsize it */
            line-height: 1.6;
        }

        .font-pixel {
            font-family: 'VT323', monospace;
        }

        /* Simple fade-in animation */
        .view {
            display: none;
            animation: fadeIn 0.5s ease-in-out;
        }

        .view.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        /* Custom button style for the theme */
        .btn-mystery {
            @apply bg-fuchsia-600/80 text-white font-bold py-3 px-6 rounded-md shadow-lg hover:bg-fuchsia-500 transition-all duration-300 ease-in-out cursor-pointer text-center border-2 border-fuchsia-400;
            text-shadow: 0 0 5px #fuchsia-300;
        }

        .btn-mystery-sm {
            @apply bg-cyan-700/80 text-white font-bold py-2 px-4 rounded-md shadow-md hover:bg-cyan-600 transition-all duration-300 ease-in-out cursor-pointer text-center border-2 border-cyan-500;
            text-shadow: 0 0 5px #cyan-300;
        }
        
        /* Disabled button for found clues */
        .btn-disabled {
            @apply bg-gray-700 text-gray-400 font-bold py-2 px-4 rounded-md shadow-md cursor-not-allowed border-2 border-gray-600;
        }


        /* Custom modal for messages */
        .modal {
            @apply fixed inset-0 bg-black/70 flex items-center justify-center p-4 z-50 transition-opacity duration-300;
        }
        
        .modal-content {
            @apply bg-gray-900 p-6 rounded-lg shadow-2xl max-w-sm w-full text-center border-2 border-fuchsia-500/70;
        }

    </style>
</head>
<body class="min-h-screen flex items-center justify-center p-4">

    <div class="max-w-3xl w-full mx-auto bg-black/80 backdrop-blur-sm rounded-lg shadow-2xl overflow-hidden border-2 border-cyan-500/50" style="box-shadow: 0 0 25px rgba(0, 255, 255, 0.3);">
        
        <!-- =================================================================
        VIEW 1: START SCREEN
        ================================================================== -->
        <div id="view-start" class="view p-8 md:p-12 active">
            <h1 class="font-pixel text-4xl md:text-5xl font-bold text-cyan-400 mb-4 text-center" style="text-shadow: 0 0 10px #0ff;">Game Over</h1>
            <p class="text-lg text-gray-300 mb-8 text-center">
                At 'The Pixel Palace', the town's most popular 90s arcade, owner 'Ace' Hargrave has been found murdered in his back office.
            </p>
            <p class="text-gray-400 mb-10 text-center">
                As the detectives, you've been called to investigate. The arcade is locked down. You must find 4 clues to unlock the office safe and find the killer.
            </p>
            <div class="flex justify-center">
                <button onclick="showView('view-hub')" class="btn-mystery text-2xl">
                    Press Start
                </button>
            </div>
        </div>

        <!-- =================================================================
        VIEW 2: MAIN HUB (The Arcade Floor)
        ================================================================== -->
        <div id="view-hub" class="view p-8 md:p-12">
            <h2 class="font-pixel text-3xl font-bold text-cyan-400 mb-6" style="text-shadow: 0 0 10px #0ff;">The Arcade Floor</h2>
            <p class="text-gray-300 mb-8">
                You stand on the main arcade floor. The suspects are milling about. Where do you want to go?
            </p>
            
            <!-- Clue Log -->
            <div id="clue-log" class="mb-6 p-4 bg-gray-900/70 rounded-lg border border-fuchsia-500/50">
                <h4 class="font-pixel text-lg text-fuchsia-400 mb-2">Clue Log:</h4>
                <p id="clue-log-text" class="text-gray-400 italic">No clues found yet...</p>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <button onclick="showView('view-scene')" class="btn-mystery-sm">Examine the Office (Crime Scene)</button>
                <button onclick="showView('view-room-prize')" class="btn-mystery-sm">Go to Prize Counter</button>
                <button onclick="showView('view-room-repair')" class="btn-mystery-sm">Go to Repair Shop</button>
                <button onclick="showView('view-room-versus')" class="btn-mystery-sm">Go to Versus Corner</button>
                <button onclick="showView('view-room-breakroom')" class="btn-mystery-sm">Go to Staff Breakroom</button>
                <button onclick="showView('view-interviews')" class="btn-mystery-sm">Talk to Suspects</button>
                <button onclick="showView('view-accuse')" class="btn-mystery-sm">Make an Accusation</button>
            </div>
        </div>

        <!-- =================================================================
        VIEW 3: SUSPECTS LIST (No longer used, combined into Interviews)
        ================================================================== -->
        
        <!-- =================================================================
        VIEW 4: INTERVIEW HUB (Now the main suspect view)
        ================================================================== -->
        <div id="view-interviews" class="view p-8 md:p-12">
            <h2 class="font-pixel text-3xl font-bold text-cyan-400 mb-6" style="text-shadow: 0 0 10px #0ff;">Talk to Suspects</h2>
            <p class="text-gray-300 mb-8">Who do you want to speak to?</p>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <button onclick="showInterview('trisha')" class="btn-mystery-sm">Trisha Hargrave</button>
                <button onclick="showInterview('lacey')" class="btn-mystery-sm">Lacey Collins</button>
                <button onclick="showInterview('doc')" class="btn-mystery-sm">'Doc' Shaw</button>
                <button onclick="showInterview('stan')" class="btn-mystery-sm">Stan "the man" Thompson</button>
                <button onclick="showInterview('liz')" class="btn-mystery-sm">Liz Harding</button>
            </div>
            <button onclick="showView('view-hub')" class="btn-mystery-sm mt-8">Back to Arcade Floor</button>
        </div>

        <!-- =================================================================
        VIEW 5: CRIME SCENE (With Safe Puzzle)
        ================================================================== -->
        <div id="view-scene" class="view p-8 md:p-12">
            <h2 class="font-pixel text-3xl font-bold text-cyan-400 mb-6" style="text-shadow: 0 0 10px #0ff;">The Crime Scene: The Back Office</h2>
            <p class="text-gray-300 mb-6">
                The office is cluttered. On the floor, you see a spilled bag of prize tokens and 'Ace' Hargrave's body. Nearby lies a bloody shard of plexiglass.
            </p>
            <p class="text-gray-300 mb-6">
                Under the desk is a large, heavy safe, locked with a 4-digit keypad. You'll need to find the combination.
            </p>
            
            <!-- This is the interactive part! -->
            <div id="clue-locked" class="bg-gray-800 p-6 rounded-lg border border-gray-700">
                <p class="text-gray-300 mb-4">A 4-digit combination is required:</p>
                
                <div class="flex flex-col sm:flex-row gap-2">
                    <input type="text" id="safe-code" placeholder="Enter 4-digit code..." maxlength="4" class="flex-grow bg-gray-900 border border-gray-600 text-white rounded-lg p-3 focus:outline-none focus:ring-2 focus:ring-fuchsia-500 font-pixel">
                    <button onclick="checkSafeCode()" class="btn-mystery">Unlock</button>
                </div>
            </div>

            <!-- This is the hidden clue -->
            <div id="clue-unlocked" class="hidden bg-green-900/50 border border-green-700 p-6 rounded-lg mt-6">
                <h3 class="font-bold text-xl text-green-300 mb-2">Safe Unlocked!</h3>
                <p class="text-green-200">
                    Inside the safe, you find a legal contract. It's a draft of Ace's will, leaving 'The Pixel Palace' *entirely* to his niece, <strong>Trisha</strong>. A handwritten note in the margin reads: "Make sure there's a clause specifically excluding Lacey C. from any ownership, ever."
                </p>
            </div>

            <button onclick="showView('view-hub')" class="btn-mystery-sm mt-8">Back to Arcade Floor</button>
        </div>

        <!-- =================================================================
        NEW VIEWS FOR CLUES
        ================================================================== -->

        <!-- Prize Counter -->
        <div id="view-room-prize" class="view p-8 md:p-12">
            <h2 class="font-pixel text-3xl font-bold text-cyan-400 mb-6" style="text-shadow: 0 0 10px #0ff;">Prize Counter</h2>
            <p class="text-gray-300 mb-6">The prize counter is full of cheap toys and candy. Liz Harding is here, nervously sorting tickets. "Please... just look around. Don't mind me."</p>
            <p class="text-gray-300 mb-6">You see the ticket sorting machine, a cash register, and shelves of prizes.</p>
            <div id="clue-prize-button">
                <button onclick="findClue('8', 'view-room-prize', 'clue-prize-button')" class="btn-mystery-sm">Search the ticket sorter</button>
            </div>
            <p id="clue-prize-text" class="text-fuchsia-400 italic text-lg mt-4 hidden">Tucked under the ticket counter, you find a crumpled sticky note. It has a number written on it: "8".</p>
            <button onclick="showView('view-hub')" class="btn-mystery-sm mt-8">Back to Arcade Floor</button>
        </div>

        <!-- Repair Shop -->
        <div id="view-room-repair" class="view p-8 md:p-12">
            <h2 class="font-pixel text-3xl font-bold text-cyan-400 mb-6" style="text-shadow: 0 0 10px #0ff;">Repair Shop</h2>
            <p class="text-gray-300 mb-6">'Doc' Shaw's repair shop is a mess of wires and old arcade parts. "Don't touch anything!" he barks. "It's all delicately calibrated!"</p>
            <p class="text-gray-300 mb-6">His main workbench is covered in tools and schematics.</p>
            <div id="clue-repair-button">
                <button onclick="findClue('3', 'view-room-repair', 'clue-repair-button')" class="btn-mystery-sm">Examine schematics</button>
            </div>
            <p id="clue-repair-text" class="text-fuchsia-400 italic text-lg mt-4 hidden">You find a schematic for a custom-rigged power supply. In the corner, 'Doc' has scribbled a note: "Power req: 3 Amps".</p>
            <button onclick="showView('view-hub')" class="btn-mystery-sm mt-8">Back to Arcade Floor</button>
        </div>

        <!-- Versus Corner -->
        <div id="view-room-versus" class="view p-8 md:p-12">
            <h2 class="font-pixel text-3xl font-bold text-cyan-400 mb-6" style="text-shadow: 0 0 10px #0ff;">Versus Corner</h2>
            <p class="text-gray-300 mb-6">This is Trisha's domain, surrounded by 'Street Fighter' and 'Mortal Kombat' cabinets. She's practicing combos on a machine. "What do you want? I'm busy."</p>
            <p class="text-gray-300 mb-6">Her game bag is sitting on a nearby stool.</p>
            <div id="clue-versus-button">
                <button onclick="findClue('1', 'view-room-versus', 'clue-versus-button')" class="btn-mystery-sm">Check her game bag</button>
            </div>
            <p id="clue-versus-text" class="text-fuchsia-400 italic text-lg mt-4 hidden">Inside her bag, you find a notebook full of strategies. On the back page is a doodle of a trophy with a number: "1".</p>
            <button onclick="showView('view-hub')" class="btn-mystery-sm mt-8">Back to Arcade Floor</button>
        </div>

        <!-- Staff Breakroom -->
        <div id="view-room-breakroom" class="view p-8 md:p-12">
            <h2 class="font-pixel text-3xl font-bold text-cyan-400 mb-6" style="text-shadow: 0 0 10px #0ff;">Staff Breakroom</h2>
            <p class="text-gray-300 mb-6">The small, grimy staff breakroom. It smells like stale coffee. Lacey's jean jacket is slung over a chair.</p>
            <p class="text-gray-300 mb-6">A locker unit stands against the far wall.</p>
             <div id="clue-breakroom-button">
                <button onclick="findClue('5', 'view-room-breakroom', 'clue-breakroom-button')" class="btn-mystery-sm">Check Lacey's jacket</button>
            </div>
            <p id="clue-breakroom-text" class="text-fuchsia-400 italic text-lg mt-4 hidden">In her jacket pocket, you find a folded bar napkin from 'The Neon Poodle' lounge. A time is written on it: "Meet Ace - 5 PM".</p>
            <button onclick="showView('view-hub')" class="btn-mystery-sm mt-8">Back to Arcade Floor</button>
        </div>


        <!-- =================================================================
        VIEW 6: MAKE AN ACCUSATION (UPDATED)
        ================================================================== -->
        <div id="view-accuse" class="view p-8 md:p-12">
            <h2 class="font-pixel text-3xl font-bold text-cyan-400 mb-6" style="text-shadow: 0 0 10px #0ff;">Make Your Accusation</h2>
            <p class="text-gray-300 mb-8">You've reviewed the evidence. Who do you believe is the killer?</p>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <button onclick="showSolution(true, 'You accuse Lacey. She breaks down. \'He promised me! We were supposed to be partners, 50/50. Then... he was just going to give it all to that *brat* Trisha and write me off! I found the contract draft in the safe. I confronted him. He laughed. I... I just snapped.\' Case Closed.')" class="btn-mystery-sm">Lacey Collins</button>
                <button onclick="showSolution(false, 'You accuse Trisha. She\'s furious. \'What?! He was giving me the arcade! I had everything I wanted! You\'re wrong!\' The real killer gets away.')" class="btn-mystery-sm">Trisha Hargrave</button>
                <button onclick="showSolution(false, 'You accuse \'Doc\' Shaw. He denies it. Despite his constant complaining, no solid evidence ties him to the murder. You\'ve made a mistake.')" class="btn-mystery-sm">'Doc' Shaw</button>
                <button onclick="showSolution(false, 'Stan Thompson scoffs. His alibi holds up, and there is no evidence linking him to the crime. A dead-end.')" class="btn-mystery-sm">Stan "the man" Thompson</button>
                <button onclick="showSolution(false, 'Liz Harding is confused by the accusation. She was just a witness. The investigation stalls.')" class="btn-mystery-sm">Liz Harding</button>
            </div>
            <button onclick="showView('view-hub')" class="btn-mystery-sm mt-8">Back to Arcade Floor</button>
        </div>

    </div>

    <!-- =================================================================
    MODAL for messages
    ================================================================== -->
    <div id="modal" class="modal hidden opacity-0" onclick="closeModal()">
        <div class="modal-content" onclick="event.stopPropagation()">
            <h3 id="modal-title" class="font-pixel text-2xl font-bold text-fuchsia-400 mb-4"></h3>
            <p id="modal-text" class="text-gray-300 mb-6"></p>
            <button onclick="closeModal()" class="btn-mystery-sm">Close</button>
        </div>
    </div>
    
    <!-- =================================================================
    MODAL for solution
    ================================================================== -->
    <div id="solution-modal" class="modal hidden opacity-0">
        <div class="modal-content" onclick="event.stopPropagation()">
            <h3 id="solution-title" class="font-pixel text-2xl font-bold mb-4"></h3>
            <p id="solution-text" class="text-gray-300 mb-6"></p>
            <button onclick="restartGame()" class="btn-mystery">Start New Game</button>
        </div>
    </div>


    <!-- =================================================================
    SCRIPT (Corrected Version)
    ================================================================== -->
    <script>
        let currentView = 'view-start';
        let foundClues = [];
        
        // Object to store interview state
        let interviewState = {
            trisha: 0,
            lacey: 0,
            doc: 0,
            stan: 0,
            liz: 0
        };

        // Object to store all suspect dialogues
        const dialogues = {
            trisha: [
                "She scoffs. 'He was finally going to listen to me! He was going to give me the arcade to run it *my* way. That Lacey... she thought she had him wrapped around her little finger. Guess not.'",
                "Look, I already told you. Ace was giving *me* the arcade. Why would I kill him? Unlike Lacey, I actually had a future here. Now, if you'll excuse me, I'm about to beat my high score."
            ],
            lacey: [
                "She dabs at her eyes. 'I... I can't believe he's gone. We were... close. He told me he was leaving the arcade to Trisha, to his *family*. I just... I just wanted us to run it together. But he said I wasn't family.'",
                "Why are you talking to me again? It's a tragedy. Ace and I were... we were very close. He was just confused, that's all. That contract in the safe... he didn't mean it. He was just trying to appease Trisha."
            ],
            doc: [
                "He's tinkering with a circuit board. 'Heard Ace and Lacey arguing up a storm last night. She was yelling about 'getting what she deserved'. Sounded nasty. C-couldn't have been me, I was... fixing this board!'",
                "You again? Look, I'm busy building... uh... *fixing*... this. If you want a *real* lead, go talk to that cashier, Liz. She's always disappearing from the counter. Comes back all nervous, covered in gray and black fur. What's that about? Weirdo."
            ],
            stan: [
                "He flashes a fake smile. 'Liz Harding works for me, yeah. She's my girl. She told me Ace was going to sell, but then changed his mind to give it to his bratty niece. Messed up my plans to buy it.'",
                "I told you, I've got an alibi. My girl Liz was just feeding me info. Ace was unstable, first wanting to sell, then giving it to his niece. It's no way to run a business. Frankly, *someone* putting him out of his misery... it's not the worst thing for *my* business. But it wasn't me."
            ],
            liz: [
                "She looks nervous. 'I... I've been working for Stan, okay? Just for extra cash! I heard Lacey and Ace yelling. She... she said 'If I can't have this place, no one can!' I was scared.'",
                "Oh... hi. Listen, you should really be looking at 'Doc' Shaw. He's *always* in that shop, says he's 'working,' but I think he's just skipping out. I bet he's an alcoholic. He's mean, too... I think he hates animals. He's always yelling about 'vermin' by the dumpsters. As for the fur... [she looks down] ...I... I just feed the raccoons out back. They're sweet. Don't tell Doc."
            ]
        };
        
        // Modal elements
        const modal = document.getElementById('modal');
        const modalTitle = document.getElementById('modal-title');
        const modalText = document.getElementById('modal-text');
        
        // Solution Modal elements
        const solutionModal = document.getElementById('solution-modal');
        const solutionTitle = document.getElementById('solution-title');
        const solutionText = document.getElementById('solution-text');
        
        // Clue Log element
        const clueLogText = document.getElementById('clue-log-text');

        // --- View Navigation ---
        function showView(viewId) {
            const oldView = document.getElementById(currentView);
            if (oldView) {
                oldView.classList.remove('active');
            }
            
            const newView = document.getElementById(viewId);
            if (newView) {
                newView.classList.add('active');
            }
            
            currentView = viewId;
            
            // Update clue log when returning to hub
            if (viewId === 'view-hub') {
                updateClueLog();
            }
        }

        // --- Clue Logic ---
        function findClue(clue, roomViewId, clueButtonId) {
            if (!foundClues.includes(clue)) {
                foundClues.push(clue);
                foundClues.sort(); // Keep them in order
                
                // Show text in room
                const clueTextElement = document.getElementById(clueButtonId.replace('-button', '-text'));
                if (clueTextElement) {
                    clueTextElement.classList.remove('hidden');
                }
                
                // Disable button in room
                const clueButtonElement = document.getElementById(clueButtonId);
                if (clueButtonElement) {
                    clueButtonElement.innerHTML = '<button class="btn-disabled" disabled>Clue Found</button>';
                }
                
                showMessage('Clue Found!', `You found a piece of the combination: ${clue}`);
            } else {
                showMessage('Already Found', 'You\'ve already searched this spot.');
            }
        }
        
        function updateClueLog() {
            if (foundClues.length === 0) {
                clueLogText.textContent = 'No clues found yet...';
            } else {
                clueLogText.textContent = `Clues: ${foundClues.join(', ')}`;
            }
        }

        // --- Puzzle Logic ---
        function checkSafeCode() {
            const safeCodeInput = document.getElementById('safe-code');
            const answer = safeCodeInput.value.trim();
            
            // The answer is the 4 clues
            const correctCode = "1358"; // The clues 8, 3, 1, 5 sorted
            
            if (answer === correctCode) {
                document.getElementById('clue-locked').style.display = 'none';
                document.getElementById('clue-unlocked').style.display = 'block';
                showMessage('Success!', 'The safe clicks open.');
            } else {
                showMessage('Locked', 'The safe remains firmly shut. Wrong code.');
            }
        }

        // --- Modal Logic ---
        function showMessage(title, text) {
            modalTitle.textContent = title;
            modalText.textContent = text;
            modal.classList.remove('hidden');
            setTimeout(() => modal.classList.remove('opacity-0'), 10);
        }

        // --- Interview Logic ---
        function showInterview(suspect) {
            let dialogueText = '';
            let title = `Interview: ${suspect.charAt(0).toUpperCase() + suspect.slice(1)}`;
            
            // Adjust title for 'Doc' and 'Stan'
            if (suspect === 'doc') title = "Interview: 'Doc' Shaw";
            if (suspect === 'stan') title = "Interview: Stan 'the man' Thompson";
            if (suspect === 'liz') title = "Interview: Liz Harding";
            if (suspect === 'lacey') title = "Interview: Lacey Collins";
            if (suspect === 'trisha') title = "Interview: Trisha Hargrave";


            if (interviewState[suspect] === 0) {
                // First time talking
                dialogueText = dialogues[suspect][0];
                interviewState[suspect]++;
            } else {
                // Second or later time talking
                dialogueText = dialogues[suspect][1];
            }
            
            showMessage(title, dialogueText);
        }

        function closeModal() {
            modal.classList.add('opacity-0');
            setTimeout(() => modal.classList.add('hidden'), 300);
        }
        
        // --- Solution Modal Logic ---
        function showSolution(isCorrect, text) {
            if(isCorrect) {
                solutionTitle.textContent = "Case Solved!";
                solutionTitle.className = "font-pixel text-2xl font-bold mb-4 text-green-400";
            } else {
                solutionTitle.textContent = "Case Unsolved";
                solutionTitle.className = "font-pixel text-2xl font-bold mb-4 text-red-400";
            }
            
            solutionText.textContent = text;
            solutionModal.classList.remove('hidden');
            setTimeout(() => solutionModal.classList.remove('opacity-0'), 10);
        }

        // --- Restart Game Logic ---
        function restartGame() {
            // Hide modal
            solutionModal.classList.add('opacity-0');
            setTimeout(() => solutionModal.classList.add('hidden'), 300);
            
            // Reset puzzle
            document.getElementById('clue-locked').style.display = 'block';
            document.getElementById('clue-unlocked').style.display = 'none';
            document.getElementById('safe-code').value = '';

            // Reset clues
            foundClues = [];
            updateClueLog();
            
            // Reset clue buttons and text
            const clueButtons = [
                'clue-prize-button', 
                'clue-repair-button', 
                'clue-versus-button', 
                'clue-breakroom-button'
            ];
            const clueTexts = [
                'clue-prize-text', 
                'clue-repair-text', 
                'clue-versus-text', 
                'clue-breakroom-text'
            ];
            
            const clueButtonActions = [
                "findClue('8', 'view-room-prize', 'clue-prize-button')",
                "findClue('3', 'view-room-repair', 'clue-repair-button')",
                "findClue('1', 'view-room-versus', 'clue-versus-button')",
                "findClue('5', 'view-room-breakroom', 'clue-breakroom-button')"
            ];

            const clueButtonTexts = [
                "Search the ticket sorter",
                "Examine schematics",
                "Check her game bag",
                "Check Lacey's jacket"
            ];
            
            for (let i = 0; i < clueButtons.length; i++) {
                document.getElementById(clueButtons[i]).innerHTML = `<button onclick="${clueButtonActions[i]}" class="btn-mystery-sm">${clueButtonTexts[i]}</button>`;
                document.getElementById(clueTexts[i]).classList.add('hidden');
            }

            // Reset interview states
            interviewState = {
                trisha: 0,
                lacey: 0,
                doc: 0,
                stan: 0,
                liz: 0
            };

            // Go to start
            showView('view-start');
        }

    </script>
</body>
</html>

